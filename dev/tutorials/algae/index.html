<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Algae growth · Virtual Plant Laboratory</title><meta name="title" content="Algae growth · Virtual Plant Laboratory"/><meta property="og:title" content="Algae growth · Virtual Plant Laboratory"/><meta property="twitter:title" content="Algae growth · Virtual Plant Laboratory"/><meta name="description" content="Documentation for Virtual Plant Laboratory."/><meta property="og:description" content="Documentation for Virtual Plant Laboratory."/><meta property="twitter:description" content="Documentation for Virtual Plant Laboratory."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Virtual Plant Laboratory</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Virtual Plant Laboratory</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/Julia/">Julia basic concepts</a></li><li><a class="tocitem" href="../../manual/Graphs/">Dynamic graph creation and manipulation</a></li><li><a class="tocitem" href="../../manual/Geometry/Primitives/">Geometry primitives</a></li><li><a class="tocitem" href="../../manual/Geometry/Turtle/">Turtle geometry and scenes</a></li><li><a class="tocitem" href="../../manual/Raytracer/">Ray tracing</a></li><li><a class="tocitem" href="../../manual/Visualization/">3D visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Algae growth</a></li><li><a class="tocitem" href="../snowflakes/">The Koch snowflake</a></li><li><a class="tocitem" href="../tree/">Tree</a></li><li><a class="tocitem" href="../forest/">Forest</a></li><li><a class="tocitem" href="../growthforest/">Growth forest</a></li><li><a class="tocitem" href="../raytracedforest/">Ray-traced forest</a></li><li><a class="tocitem" href="../context/">Context sensitive rules</a></li><li><a class="tocitem" href="../relationalqueries/">Relational queries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/GridCloner/">Setting up a grid cloner</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/graphs/">Graphs</a></li><li><a class="tocitem" href="../../api/geometry/">Scenes and 3D meshes</a></li><li><a class="tocitem" href="../../api/turtle/">Turtle geometry</a></li><li><a class="tocitem" href="../../api/raytracer/">Ray tracing</a></li><li><a class="tocitem" href="../../api/viz/">3D visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">VPLVerse</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">SkyDomes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../VPLVerse/SkyDomes/">SkyDomes package</a></li><li><a class="tocitem" href="../../VPLVerse/SkyDomes/API/">SkyDomes API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Ecophys</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../VPLVerse/Ecophys/">Ecophys package</a></li><li><a class="tocitem" href="../../VPLVerse/Ecophys/photosynthesis/">Photosynthesis API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">PlantSimEngine</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../VPLVerse/PlantSimEngine/">PlantSimEngine package</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">PlantBioPhysics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../VPLVerse/PlantBioPhysics/">PlantBioPhysics package</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../developers/organization/">Internal organization</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Algae growth</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Algae growth</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/VirtualPlantLab/VPLDocs/blob/master/docs/src/tutorials/algae.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Algae-growth"><a class="docs-heading-anchor" href="#Algae-growth">Algae growth</a><a id="Algae-growth-1"></a><a class="docs-heading-anchor-permalink" href="#Algae-growth" title="Permalink"></a></h1><p>Alejandro Morales</p><p>Centre for Crop Systems Analysis - Wageningen University</p><p>In this first example, we learn how to create a <code>Graph</code> and update it dynamically with rewriting rules.</p><p>The model described here is based on the non-branching model of <a href="https://en.wikipedia.org/wiki/L-system#Example_1:_Algae">algae growth</a> proposed by Lindermayer as one of the first L-systems.</p><p>First, we need to load the VPL metapackage, which will automatically load all the packages in the VPL ecosystem.</p><pre><code class="language-julia hljs">using VirtualPlantLab</code></pre><p>The rewriting rules of the L-system are as follows:</p><p><strong>axiom</strong>:   A</p><p><strong>rule 1</strong>:  A <span>$\rightarrow$</span> AB</p><p><strong>rule 2</strong>:  B <span>$\rightarrow$</span> A</p><p>In VPL, this L-system would be implemented as a graph where the nodes can be of type <code>A</code> or <code>B</code> and inherit from the abstract type <code>Node</code>. It is advised to include type definitions in a module to avoid having to restart the Julia session whenever we want to redefine them. Because each module is an independent namespace, we need to import <code>Node</code> from the VPL package inside the module:</p><pre><code class="language-julia hljs">module algae
    import VirtualPlantLab: Node
    struct A &lt;: Node end
    struct B &lt;: Node end
end
import .algae</code></pre><p>Note that in this very example we do not need to store any data or state inside the nodes, so types <code>A</code> and <code>B</code> do not require fields.</p><p>The axiom is simply defined as an instance of type of <code>A</code>:</p><pre><code class="language-julia hljs">axiom = algae.A()</code></pre><p>The rewriting rules are implemented in VPL as objects of type <code>Rule</code>. In VPL, a rewriting rule substitutes a node in a graph with a new node or subgraph and is therefore composed of two parts:</p><ol><li>A condition that is tested against each node in a graph to choose which nodes to rewrite.</li><li>A subgraph that will replace each node selected by the condition above.</li></ol><p>In VPL, the condition is split into two components:</p><ol><li>The type of node to be selected (in this example that would be <code>A</code> or <code>B</code>).</li><li>A function that is applied to each node in the graph (of the specified type) to indicate whether the node should be selected or not. This function is optional (the default is to select every node of the specified type).</li></ol><p>The replacement subgraph is specified by a function that takes as input the node selected and returns a subgraph defined as a combination of node objects. Subgraphs (which can also be used as axioms) are created by linearly combining objects that inherit from <code>Node</code>. The operation <code>+</code> implies a linear relationship between two nodes and <code>[]</code> indicates branching.</p><p>The implementation of the two rules of algae growth model in VPL is as follows:</p><pre><code class="language-julia hljs">rule1 = Rule(algae.A, rhs = x -&gt; algae.A() + algae.B())
rule2 = Rule(algae.B, rhs = x -&gt; algae.A())</code></pre><p>Note that in each case, the argument <code>rhs</code> is being assigned an anonymous (aka <em>lambda</em>) function. This is a function without a name that is defined directly in the assigment to the argument. That is, the Julia expression <code>x -&gt; A() + B()</code> is equivalent to the following function definition:</p><pre><code class="language-julia hljs">function rule_1(x)
    algae.A() + algae.B()
end</code></pre><p>For simple rules (especially if the right hand side is just a line of code) it is easier to just define the right hand side of the rule with an anonymous function rather than creating a standalone function with a meaningful name. However, standalone functions are easier to debug as you can call them directly from the REPL.</p><p>With the axiom and rules we can now create a <code>Graph</code> object that represents the algae organism. The first argument is the axiom and the second is a tuple with all the rewriting rules:</p><pre><code class="language-julia hljs">organism = Graph(axiom = axiom, rules = (rule1, rule2))</code></pre><p>If we apply the rewriting rules iteratively, the graph will grow, in this case representing the growth of the algae organism. The rewriting rules are applied on the graph with the function <code>rewrite!()</code>:</p><pre><code class="language-julia hljs">rewrite!(organism)</code></pre><p>Since there was only one node of type <code>A</code>, the only rule that was applied was <code>rule1</code>, so the graph should now have two nodes of types <code>A</code> and <code>B</code>, respectively. We can confirm this by drawing the graph. We do this with the function <code>draw()</code> which will always generate the same representation of the graph, but different options are available depending on the context where the code is executed. By default, <code>draw()</code> will create a new window where an interactive version of the graph will be drawn and one can zoom and pan with the mouse (in this online document a static version is shown, see <a href="../../manual/Visualization/">Backends</a> for details):</p><pre><code class="language-julia hljs">import GLMakie
draw(organism)</code></pre><p>Notice that each node in the network representation is labelled with the type of node (<code>A</code> or <code>B</code> in this case) and a number in parenthesis. This number is a unique identifier associated to each node and it is useful for debugging purposes (this will be explained in more advanced examples).</p><p>Applying multiple iterations of rewriting can be achieved with a simple loop:</p><pre><code class="language-julia hljs">for i in 1:4
    rewrite!(organism)
end</code></pre><p>And we can verify that the graph grew as expected:</p><pre><code class="language-julia hljs">draw(organism)</code></pre><p>The network is rather boring as the system is growing linearly (no branching) but it already illustrates how graphs can grow rapidly in just a few iterations. Remember that the interactive visualization allows adjusting the zoom, which is handy when graphs become large.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../manual/Visualization/">« 3D visualization</a><a class="docs-footer-nextpage" href="../snowflakes/">The Koch snowflake »</a><div class="flexbox-break"></div></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Saturday 11 November 2023 16:51">Saturday 11 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
